Shortcut Upgrade dos Ambiente Nuvem de 3.0.0 para 3.3.0 
=======================================================


A. Upgrade de forma automatizada:
=================================
    
1. (i)   Atualizar a versão do .jar no arquivo "FornecedorRepositorio.java" para a Marizpan
   (ii)  Executar Maven para compilar e atualizar o arquivo integr-fornecedor-x.y.z.jar

	
1. (i)  Gerar o Instalador no Eclipse.
   (ii) Zippar o Instalador para o arquivo PatchNuvem3.3.0.zip
        colocando a senha cronos@2019 no arquivo .zip para evitar uso indevido e hackeado. 
 
2. a. Verificar se o usuário logado é administrador ou administrator, 
      local ou da rede, abrindo e fechando cmd.exe (como administrador da rede ainda não foi testado).
	      
   b. Verificar se o usuário logado consegue abrir o botão "Environment Variables" 
      no Control Panel > System > Advanced System Settings > "Environment Variables".
      Caso contrário, provavelmente o usuário logado é de uma máquina virtual. 
      Pedir a TI conectar com um usuário administrador na máquina real debaixo da máquina virtual.
	      
   c. Nas opções do Windows Explorer marcar "Mostrar arquivos, pastas e unidades ocultas"  
      (foi testado no fornecedor Padeirão que não precisa desmarcar "Hide protected operating system files").
      Fechar e re-abrir o Windows Explorer. Senão re-abrir o Windows Explorer, 
      vai pensar indevidamente que não existe o dir C:\ProgramData\ por exemplo............. 
	
   d. Copiar o arquivo PatchNuvem3.3.0.zip para a máquina de Bernardino e pedir ele copiar isso 
      para o servidor do APS Cloud. 
   
   e. Unzippar no dir C:/temp/ (senha cronos@2019)
   
   f. Backup do arquivo de configuração da Marizpan para o diretório C:/Eric/ 


3. Esperar até o processo atual do Integrador terminou.
 
4. (i)   Primeiro verificar que o desinstalador local (da versão anterior 3.0.0 não desinstala java!!!
         No caso, descomentar "goto SKIP_JRE"
   (ii)  Executar o Desinstalador como Administrador   
   (iii) Verificar se o Desinstalador apagou o menu de Windows, a Task Schedule, e os diretórios


5. Re-instalar a Marizpan: 
	- Adicionar cliente novo "Marizpan"
	- Recuperar o conteúdo do backup do config da Marizpan para "Integração APS - Portal Cronos.Marizpan.properties"
	  
	-     (i)  No Windows Explorer alterar a opção para NÃO exibir arquivos de sistema operacional protegidos, 
		       (marcar "Hide protected operating system files")  
		       porém pode exibir hidden files, para todos os usuários inclusive cronostech 
		       (marcar "Show hidden files, folders, and drives")
		  (ii) Verificar se o diretório "Arquivos de Programas PC" ficou invisível no Windows Explorer como deveria


6. Em todos os casos: 
     - Acompanhar 15 minutos se o Integrador começa executar automaticamente
     
7. Atualizar o arquivo .jar no servidor de monitoramento (não precisa atualizar o servidor do fornecedor)
   esperando o processamento atual terminar primeiro
   




B. Upgrade de forma manual:
===========================

1. Verificar se o usuário logado é administrador ou administrator, 
   local ou da rede, abrindo e fechando cmd.exe (como administrador da rede ainda não foi testado).
	      
	      
2. Remover os seguintes arquivos:
				- /bin/DesinstalarManualTI.bat (pois foi renomeado para /bin/Desinstalador.bat)
        		- Job15a15minOfertamentoJava_Windows.bat
        		- Job15a15minOfertamentoJava.log
   
   
 
3. Apagar "Desinstalar_Integração_Fornecedor_PortalCronos.bat" 
 

4. a. Zippar os seguintes arquivos para o arquivo PatchNuvem.3.3.0.zip:
			- bin\CaminhoJRE.bat
			- bin\Inicializacoes.bat
			- bin\Desinstalador.bat
			- bin\VerificarUsuarioAdministrador.bat
       	    - bin\Versao.bat 
        	- Integração Fornecedor - Portal Cronos\integr-fornecedor-3.3.0.jar
   			- Integração Fornecedor - Portal Cronos\Job15a15min.bat
			- Arquivos de Programas PC\AbrirConfigFornecedor.bat
        	- Arquivos de Programas PC\AdicionarFornecedorNuvem.bat
        	- Arquivos de Programas PC\RemoverFornecedorNuvem.bat 
        	- Arquivos de Programas PC\Desinstalador_Integrador_ou_Monitorador.bat
 
   b. Copiar o arquivo zip para o diretório C:\Eric\ no servidor do APS Cloud.
   
   c. Ajeitar os start-dates das Task Schedules da Marizpan e da Atacamax, etc, da seguinte forma: 
   		  (i)    Backup dos configs da Marizpan, Atacamax, e de todos os outros fornecedores
          (ii)   Abrir o Agendador de Tarefas de Windows e verificar o minuto atual dos agendamentos, 
   		         e verificar se batem com o relatório RelatorioHorasIniJobsFornecedores.launch, 
   		         coluna "Minuto Atual"
   		  (iii)  Remover todas as instâncias (primeiro esperar até o processo da instância terminoou)
   		  (iv)   Instalar os arquivos novos listados no item (a) acima 
   		  (v)    Clicar em "Adicionar instância" para todos os fornecedores
   		  (vi)   Verificar os Start Times novos de todos eles no Task Scheduler: 
   		         verificar se os minutos dos agendamentos novos batem com o relatório 
   		         RelatorioHorasIniJobsFornecedores.launch, coluna "Minuto Futuro"
   		  (vii)  Verificar se o novo renomeado Job15a15min.bat é chamado
   		  (viii) Ajeitar os ícones no menu de Windows manualmente (no caso que isso não foi automatizado ainda)
   		  
   d. Verificar manualmente todos os ícones no menu de Windows criados com a versão anterior do Integrador
   
   
5.   (i)  No Windows Explorer alterar a opção para não exibir arquivos de sistema 
          (marcar "Hide protected operating system files")
     (ii) Fechar o Windows Explorer e abrir novamente


6.   - Acompanhar 15 minutos se o Integrador começa executar automaticamente
     - Verificar se o Integrador gerou o novo arquivo:
     		- Job15a15min.%1.log no caso do servidor do APS Cloud
     		- Job15a15min.log    em todos os outros casos
     
     
7. (i)   Atualizar a versão do .jar no arquivo "FornecedorRepositorio.java" para o fornecedor que foi atualizado
   (ii)  Compilar o arquivo .jar
   (iii) Atualizar o arquivo .jar no servidor de monitoramento (não precisa atualizar o servidor do fornecedor)
         esperando o processamento atual terminar primeiro
   
