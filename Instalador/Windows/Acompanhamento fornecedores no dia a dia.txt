
Email/Skype padrão: veja email automatizado no arquivo IntegracaoFornecedorCompleta.java 

OBSERVAÇÕES: 
   1. EDITAR O MANUAL EM ANEXO: SUBSTITUIR "WINTHOR/APS/ETC"  E  "ORACLE/FIREBIRD/ETC" 
      E "AnyDesk/Team Viewer" E "ws-jrembalagem" E "boa tarde/dia"
   2. SÓ COPIAR LEAO DEPENDENDO DO HORÁRIO E LOCAl (CASA / APPLY):
   3. PREPARAR O EMAIL NA HORA QUE A ALERTA AUTOMÁTICA CHEGAR, PORÉM ESPERAR MAIS 15 MINUTOS 
      PARA A SEGUNDA TENTATIVA DE OFERTAMENTO POIS É NORMAL QUE DE VEZ EM QUANDO O SERVIDOR 
      ESTÁ INDISPONÍVEL ALGUNS MINUTOS. 
      DE TODO JEITO NA HORA DE ENVIAR O EMAIL, VERIFICAR NOVAMENTE SE O SERVIÇO JÁ TINHA VOLTADO 
      A FUNCIONAR.      
   4. NÃO ADICIONAR NO MANUAL PARA A TI VERIFICAR OS ARQUIVOS DE LOG DE ERRO 
      NO DIR C:\TEMP\PORTAL CRONOS\XML\ POIS ELES VÃO OLHAR EM ARQUIVOS ANTIGOS 
      QUE NÃO TEM NADA A VER COM O PROBLEMA!   
   5. SE A PARADA COMEÇÕU NO FINAL DA SEMANA, SEGUNDA-FEIRA ESPERAR ATÉ 9:00 - 10:00 
      PARA VER SE O TI JÁ RESOLVE SOZINHO QUE FALTOU ENERGIA OU INTERNET OU OUTRA COISA.  
           





Assunto: JR Embalagem -  Problema no servidor de hospedagem da integração PCronos/WinThor
Para: jrembalagem.ti@gmail.com
Ivan, bom dia!
 
  ontem (19/02/2018) de 11:00 até 21:00 o serviço das ofertas automáticas no servidor da JR Embalagem 
estava comunicando com o Portal Cronos, enviando arquivos REC_*.xml, porém não estava enviando arquivos OFE_*.xml, 
então não estava ofertando. Precisamos descobrir a causa para evitar que acontece novamente.   

1. Favor verificar no diretório C:\Arquivos de Programas PC\Integração Fornecedor - Portal Cronos\ 
    se existir um dos seguintes tipos de arquivos de log com data no período acima: 
     - hs_err_pidxxxx.mdmp?
     - hs_err_pidxxxx.log?
     - replay_pidxxxx.log?
     
2. Favor verificar no arquivo de log de Windows se aconteceram alertas que a memória RAM estava cheia neste período 
    (Painel de Controle > Ferramentas Administrativas > Visualizar Eventos > Logs do Windows > Aplicativo)
    No caso, tem como descobrir o percentual de memória RAM ocupada exatamente?
         
3. Estava rodando um scan de anti-virus neste período?
 
4. Favor enviar para mim o maior arquivo Debugxxxxx.log com data dentro deste período que se encontra 
    no outro diretório  C:\ProgramData\PortalCronos\Logs\Local\.
    Estou precisando disso para achar uma forma para automatizar o re-processamento das cotações pendentes 
    após a liberação da memória RAM, ou após a volta de uma queda do banco Oracle. 
   
    
Observação: O servidor de hospedagem do serviço das ofertas automáticas 
             é o servidor no qual existe um diretório C:\Arquivos de Programas PC\ 
             
Atc,
Eric 




==========================================================================================================
DIVERSOS: 

NO CASO DE PROBLEMAS COM A LICENÇA DO TEAM VIEWER:
Skype:
Existem 2 tipos de instalação do Team Viewer: "free" (pessoal) e "trial"/pago (empresarial). 
Meu Team Viewer é "free" e pessoal então não consigo conectar com seu Team Viewer empresarial. 
Você quer desinstalar sua versão "trial" (ou pago?) e instalar a versão "free" do Team Viewer? 
Caso contrário, sugiro instalar o AnyDesk, que é sempre de graça. 
Como última opção vou falar com Leão para ele pagar a licença do Team Viewer empresarial. 
Como vai ser?

	
Skype:
Quando você desocupar o servidor, me avise


Skype:
Bom dia! Favor colocar o  AnyDesk no ar 5 minutos para uma atualização de versão. Agora vai ser a última vez de verdade por um bom tempo.


Skype:
Felipe, bom dia! Vocês têm um servidor Linux no Marítimos Pescados? 
Se quiser, posso instalar a integração WinThor/Portal Cronos no servidor Linux, 
pois com o servidor atual, desde muito tempo, o Portal Cronos nunca mais está recebendo ofertas automáticas do Marítimos Pescados...

Skype:
Felipe, boa tarde! Você não prefere que vou instalar a integração WinThor/Portal Cronos em outro servidor de vocês?
Pois com o servidor atual, desde muito tempo, o Portal Cronos nunca mais está recebendo ofertas automáticas do Marítimos Pescados...

Felipe, hoje estou disponível, aproveita! Você tem outro servidor para instalar a integração WinThor/PCronos? 

Isso resolveu o problema. O WinThor voltou a enviar as ofertas automaticamente para o Portal Cronos

Vou desconectar o Team Viewer, obrigado

NO CASO DO ANYDESK:
Tem como definir uma senha de acesso no AnyDesk? A grande vantagem disso é que não vou precisar aguardar seu clique "OK" toda vez que o AnyDesk cair.
Isso é muito importante para evitar ainda mais atraso e ainda mais perda de oportunidades de vendas pela Prolac   
  
  	CASO QUE NÂO:
	Então hoje vou precisar de sua confirmação diversas vezes! A Anydesk caiu neste momento!

Email:
PARA GANHAR TEMPO:
Leão, Marcelo,
 
  configurei as 2 versões de Java em paralelo e executei o serviço de ofertamento automático uma vez, com sucesso.
Apenas falta resolver um problema que o serviço ainda não está rodando de 15 a 15 minutos.
Isso vou resolver depois do almoço com mais calma, pois no momento não tem mais cotações pendentes e a próxima cotação
nova que será lançada no futuro vai vencer daqui há pelo menos 5 horas.
Apenas tem alguns produtos com problema, isso é com vocês. Favor resolver ou encaminhar para o gerente de vendas:
O Código de Produto 103.746 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
O Código de Produto 119381 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
O Código de Produto 118533 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
O Código de Produto 116970 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
O Código de Produto 117052 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
O Código de Produto 108271 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
O Código de Produto 119113 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
O Código de Produto 119754 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
O Código de Produto 101488 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor Comercial Prolac.
 
Atc,
Eric


Leão,
 
descobri um bug novo na tabela de log que fica acusando indevidamente (na maioria dos casos) que "a cotação não foi ofertada porque o usuário já fez isso manualmente" então  fiquei enganado.
Na verdade a tabela de log comprova que o gerente de vendas Marco Aurelio da JR Embalagem entende muito bem que o sistema está ofertando automaticamente
e mesmo assim, segundo a tabela de log, ele fica ofertando manualmente o tempo todo por 3 motivos:  
 
1. por causa do bug das 2 interpretações da condição de pagamento "21 / 28 dias" e outras,
    veja o email abaixo.
 
2. Outro motivo deve ser que o gerente de vendas Marco Aurelio simplesmente não sabe que os seguintes CNPJ´s
    não estão cadastrados no WinThor, então seria melhor informar ele (jrembalagem.posvenda@gmail.com):
    O CNPJ 00501070000123 da empresa compradora Softex Recife
    O CNPJ 04208473000130 da empresa compradora Di Branco Recepções
    O CNPJ 04998127000100 da empresa compradora Skillus Classic - Ilha do Leite
    O CNPJ 06035073000103 da empresa compradora CEASA - PE
    O CNPJ 08873461000180 da empresa compradora Chiwake
    O CNPJ 11553247000151 da empresa compradora Restaurante O Pátio Café, Cozinha e Eventos
    O CNPJ 16099143010790 da empresa compradora Central Mineiro Delivery
    O CNPJ 16888022000170 da empresa compradora Subcondomínio Riomar Recife
    O CNPJ 22063740000100 da empresa compradora Genki
    O CNPJ 28851899000175 da empresa compradora Portal da Picanha
 
Seria bom aproveitar também informar Marco Aurelio os seguintes erros:
O Código de Produto 23036 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 25224 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 25228 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 26032 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 26033 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 26034 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 26035 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 26037 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 26284 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
O Código de Produto 26628 do Fornecedor, informado na tela De-Para de Produtos no Portal Cronos, não existe no sistema WinThor do fornecedor JR Embalagem.
 
Eric
 

De: eric.jo@bol.com.br
Enviada: 2017/12/06 17:36:30
Para: leao@cronos-tech.com.br
Assunto: Bug novo impedindo ofertas automáticas via integração
 
Leão,
 
encontrei um bug grave na integração automatizada de ofertas:
a Formaggio não ofertou a cotação 191-0272 indevidamente porque a Condição de Pagamento "21 dias"
cadastrada no APS segundo o web service do Portal Cronos
   "não pode ser diferente da condição "21 / 28 dias" definida obrigatoriamente na cotação".
Porém acho que o correto seria permitir "21 dias" pois "21 dias" faz parte de "21 ou 28 dias".
Concorda?
Vou colocar isso onde na lista de atividades? Acho que dá para resolver rapidinho em 1 ou 2 horas,
 
Eric



Assunto: URGENTE! - Comercial Prolac - Parada integração PCronos/WinThor  
Marcelo, bom dia!

desde sábado (14/04/2018) 00:40 o Portal Cronos não está mais recebendo ofertas automáticas da Prolac.
Esta vez a causa não é apenas a placa de rede do servidor de banco, porém esta vez também o servidor
que está hospedando o serviço das ofertas automáticas não está "pingando"!

É urgente pois tem muitos produtos vendidos pela Prolac (200 "Meus Produtos") pendentes sem ofertas vencendo hoje no horário de almoço!
 
Atc,
Eric



Assunto: Favor ativar o AnyDesk - Versão nova 2.3.1 da integração PCronos/WinThor
Marcelo,
 
   favor ativar o AnyDesk e informar o ID no Skype (contato "Eric Jo"), pois preciso atualizar a versão da integração.
É necessário para melhorar a lentidão pois o ofertamento não pode demorar mais de 15 minutos,
visto que o serviço roda de 15 a 15 minutos,
 
Eric
  
==========================================================================================================
NO CASO DE UMA PARADA POR CAUSA DE ATUALIZAÇÃO JAVA:

Skype:
Java foi atualizado para qual sistema/programa exatamente?
 
Quando você desocupar o servidor, me avise
 
Email:
Assunto: Re: Migração Java
Marcelo,
  
  O WinThor voltou a enviar as ofertas automaticamente para o Portal Cronos 
  
  
Marcelo,
 
   estou adaptando nosso serviço de integração WinThor/PCronos para a versão super-nova de Java que você tinha instalado ontem de repente.
Previsão: segunda-feira ou terça-feira.
Então favor avisar os vendedores para ficar ofertando manualmente durante alguns dias.
 
Na próxima vez favor me avisar da próxima migração de Java com alguns dias de antecedência!
 
Outra opção seria instalar 2 versões diferentes de Java em paralelo, uma versão para o WinThor, e outra versão para o Portal Cronos,
porém isso tem um risco pequeno que o WinThor vai parar de funcionar para todos os usuários. Você quer correr este risco? 
Esta opção também não é tão fácil e deveria ser feito com calma para minimizar os riscos, então mesmo se você escolher esta opção mais riscado, a previsão vai ser segunda-feira também,
 
Atc,  
Eric


Marcelo, 
  
   a migração de Java foi concluída e o serviço de integração voltou a ofertar automaticamente 
a cada 15 minutos. 
Pode fechar o AnyDesk,
   
Atc,
Eric
 
==========================================================================================================
--
-- Scripts: 
--
==========================================================================================================
Script 1:

SELECT  *
  FROM [PCronos_Producao].[dbo].[Integracao_Cotacao_Fornecedor]
  where id_fornecedor_fornec = 
order by dt_envio_cotacao_icotfor desc


-- Verificar se pelo menos os usuários estão ofertando manualmente: 

update [PCronos_Producao].[dbo].[Usuario_Sistema]  
    set id_fornecedor_fornec = 
  where cd_usuario_sistema_ususis = 'ericcoringa'


-- e em seguida conectar no Portal Cronos como ericcoringa

-- Acompanhar se já está resolvido:

exec dbo.monitorarIntegracaoFornecedores @incremental_15min = 0


-- Se precisar, re-processar cotações com 3 tentativas:

delete
  FROM [PCronos_Producao].[dbo].[Integracao_Cotacao_Fornecedor]
  where id_cotacao_cot in ()  -- Copiar todos os id´s de uma vez de 
                              -- "exec dbo.monitorarIntegracaoFornecedores @incremental_15min = 0"
                              -- e adicionar vírgulas
  and id_fornecedor_fornec = 

==========================================================================================================
Script 2:

-- Verificação de cadastros de clientes e produtos: 

declare @fornecedor_id  int
set @fornecedor_id = 

select distinct ds_ocorrencia_logeint
  from dbo.Log_Erro_Integracao
 where id_fornecedor_fornec = @fornecedor_id
   and dt_hr_ocorrencia_logeint > DATEADD("DAY", -8, getdate())
   and isnull(ds_ocorrencia_logeint, '') not like '%está fora dos padrões do mercado.'
 

-- Levantamento específico para fornecedores que ficam ofertando manualmente 
-- ao mesmo  tempo como o web service:
select max(SUBSTRING(lei.ds_ocorrencia_logeint, 32, LEN(lei.ds_ocorrencia_logeint)))
     , comp.nm_pessoa  as nm_comprador
     , SUBSTRING(lei.ds_ocorrencia_logeint, 0, 32)
  from dbo.Log_Erro_Integracao lei
       INNER JOIN      dbo.Cotacao            as c    on lei.cd_cotacao_logeint   = c.cd_cotacao_cot
       INNER JOIN      dbo.Comprador          as co   on co.id_comprador_compr = c.id_comprador_compr
       INNER JOIN      dbo.pessoa             as comp on comp.id_pessoa = co.id_pessoa 
 where lei.id_fornecedor_fornec = @fornecedor_id
   and lei.dt_hr_ocorrencia_logeint > DATEADD("DAY", -8, getdate())
   and isnull(lei.ds_ocorrencia_logeint, '') not like '%está fora dos padrões do mercado.'
   and isnull(lei.ds_ocorrencia_logeint, '')     like '%O CNPJ%'
group by comp.nm_pessoa
       , SUBSTRING(lei.ds_ocorrencia_logeint, 0, 32)  
UNION
select lei.ds_ocorrencia_logeint
     , comp.nm_pessoa  as nm_comprador
     , lei.ds_ocorrencia_logeint
  from dbo.Log_Erro_Integracao lei
       INNER JOIN      dbo.Cotacao            as c    on lei.cd_cotacao_logeint   = c.cd_cotacao_cot
       INNER JOIN      dbo.Comprador          as co   on co.id_comprador_compr = c.id_comprador_compr
       INNER JOIN      dbo.pessoa             as comp on comp.id_pessoa = co.id_pessoa 
 where lei.id_fornecedor_fornec = @fornecedor_id
   and lei.dt_hr_ocorrencia_logeint > DATEADD("DAY", -8, getdate())
   and isnull(lei.ds_ocorrencia_logeint, '') not like '%está fora dos padrões do mercado.'
   and isnull(lei.ds_ocorrencia_logeint, '') not like '%O CNPJ%'


-- Levantamento específico de DE/PARA´s de Produtos:
select distinct lei.ds_ocorrencia_logeint
  from dbo.Log_Erro_Integracao lei
 where lei.id_fornecedor_fornec = @fornecedor_id
   and lei.dt_hr_ocorrencia_logeint > DATEADD("DAY", -20, getdate())
   and isnull(lei.ds_ocorrencia_logeint, '') like 'O Código de Produto %'

==========================================================================================================
