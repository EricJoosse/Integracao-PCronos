Roteiro Geração e Atualização do Instalador + checklist ANTES da instalação em um fornecedor novo 
==================================================================================================
    1. Atualizar o único /conf/.properties file no diretório da instalação 
       C:\PCronos\Integração Fornecedor - Portal Cronos\Instalador\Windows\Arquivos de Programas PC\Integração Fornecedor - Portal Cronos\conf\.
        Executar Maven para atualizar integr-fornecedor-x.y.z.jar.

	2. Conectar no Team Viewer
	
	   Skype:
	   Existem 2 tipos de instalação do Team Viewer: free (pessoal) e pago/trial (empresarial)
O meu é free e pessoal então não consigo conectar com seu Team Viewer empresarial. 
Você quer instalar a versão free do Team Viewer? Caso contrário, sugiro instalar o AnyDesk.

	
	3. a. Verificar se o usuário logado é administrador ou administrator, 
	      local ou da rede (como administrador da rede ainda não foi testado).
	      (Formaggio: user "techcorp")
	      
	   b. Nas opções do Windows Explorer marcar "Exibir Arquivos do Sistema e Arquivos Ocultos". 
	      Fechar e re-abrir o Windows Explorer. Senão, vai pensar indevidamente que não existe o dir 
	      C:\ProgramData\ por exemplo............. 
	
	4. No arquivo "Primeira_Instalacao_Versao_Windows.bat" : 
		- Verificar a versão de Windows no servidor do fornecedor 
		  e descomentar a variável "osVersion" correta no início do .bat. 
		  CMD: winver
		  ou:  systeminfo | findstr OS
		  
		- Verificar a variável "tipoOS=32" ou "tipoOS=64" no .bat
		
		- Se a versão de Windows ainda não está homologada, 
		  comentar "regedit.exe /s %arquivoRegedit%" no  "if %tipoOS% == 64" ou "32".		  
		  CUIDADO PARA NÃO CORROMPER O REGEDIT !!!!!!!!!
		  CUIDADO PARA NÃO CORROMPER O REGEDIT !!!!!!!!!
		  CUIDADO PARA NÃO CORROMPER O REGEDIT !!!!!!!!!
		  
		  Também comentar :
		  	) 
		  	REM else (
			REM     echo MSGBOX "Esta versão de Windows ainda não está suportada ! Favor entrar em contato com o Suporte do Portal Cronos." > %temp%\TEMPmessage.vbs
    		REM 	call %temp%\TEMPmessage.vbs
			REM     del %temp%\TEMPmessage.vbs /f /q
			REM     exit
			REM )
			
		  Observação ; depois de "REM" deve ter pelo menos UM espaço em branco !!!!!

		- Verificar a variável "set drive=C:"  ou "set drive=D:" no início de Primeira_Instalacao_Versao_Windows.bat 
		  Verificar se tem espaço livre de 1 GB nos discos C:/, D:/, etc. :
			- 303 MB : 
				- C:\Arquivos de Programas PC\*
				- C:\Program Files\Java\jre1.8.0_92\*
				- C:\temp\Instalar Integração Fornecedores - Portal Cronos.exe
			- 700 MB :
				- C:\temp\PortalCronos\XML\*.xml  (estimativa inicial do tamanho de 1 ano de arquivos de XML)

		  
		- Verificar se precisa descomentar um dos seguintes skips no início de Primeira_Instalacao_Versao_Windows.bat :
						REM goto SKIP_JRE
						REM goto SKIP_JRE_TEMPDIR
						REM goto SKIP_JRE_TEMPDIR_PROGRAMDIR
						REM goto SKIP_JRE_TEMPDIR_PROGRAMDIR_TASK
		  e verificar eventuais outros goto´s 
 
    5. Regerar o instalador, veja o "Manual para a geração do instalador Setup.exe" abaixo.
    
    6. O instalador pode ser copiado para qualquer diretório no servidor do fornecedor.
       Por padrão copiar para C:\temp\.
    
    7. Antes da instalação :
       					        
          0. Primeiro fazer backup (no arquivo "Backup variáveis de ambiente do sistema Path de Windows.txt"):
                (i)  do variável de ambiente do sistema "Path" de Windows: 
                (ii) do diretório  C:\ProgramData\Oracle\Java\javapath\
                
             e verificar :
              
       	  1. se já tinha C:\ProgramData\Oracle\Java\javapath\ na primeira posição no PATH antes da minha instalação
       	       (i)   no variável de ambiente do usuário administrador
       	       (ii)  no variável de ambiente do sistema
     	  2. se tem outro caminho de java no PATH e se java.exe se encontra em um dos caminhos do PATH, 
     	     por exemplo em C:\WINDOWS\System\
       	       (i)   no variável de ambiente do usuário administrador
       	       (ii)  no variável de ambiente do sistema
     	  3. No caso que já tinha um C:\ProgramData\Oracle\Java\javapath\ no servidor, fazer backup dos atalhos atuais 
     	     antes da instalação.
       	       (i)   do variável de ambiente do usuário administrador
       	       (ii)  do variável de ambiente do sistema

       No caso que no servidor do fornecedor já tem outra versão mais antiga do JRE instalada na mesma maquina, 
       depois da instalação remover C:\ProgramData\Oracle\Java\javapath\ na primeira posição no PATH, se não tinha antes. 
       Isso é para evitar que programas de terceiros param de funcionar corretamente.

       No caso que no servidor do fornecedor já tinha outra versão mais nova do JRE instalada na mesma maquina, 
       após a instalação voltar os atalhos em C:\ProgramData\Oracle\Java\javapath\ para como estava antes.

 
    8. Após a instalação :
    
    8a. Verificar e comparar o variável de ambiente do sistema "Path" de Windows
    
    8b. Restaurar o backup de C:\ProgramData\Oracle\Java\javapath\, no caso.
     
    8c. No caso de servidores 64 bit, corrigir as seguintes chaves manualmente no regedit :
          [HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Runtime Environment\1.8.0_92\MSI]
			   "JAVAUPDATE"="0"
			   "AUTOUPDATECHECK"="0"
           
       Isso é por causa do seguinte bug : 
       ----------------------------------
       O regedit.exe e o jre-8u92-windows-x64.exe são incompatíveis em relação a : 
	 	HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\JavaSoft\Java Runtime Environment\1.8.0_92\MSI
	      e 
        HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft\Java Runtime Environment\1.8.0_92\MSI

		=> Bug da oracle no instalador do jre.64.exe : 
		   está criando as chaves no lugar errado, no lugar do 32 bit 
		=> O regedit.exe 64 bits automaticamente substitui \SOFTWARE\ por \SOFTWARE\Wow6432Node\
       
       
    9. No caso que a versão de Windows ainda não está homologada,
       após a instalação, fazer um export de teste das chaves do regedit no servidor
	   e comparar com os arquivos .reg no instalador.
	   No caso, criar um novo arquivo DeshabilitarJavaUpdates.xxxxxxxxxxx.reg, 
	   e adaptar Primeira_Instalacao_Versao_Windows.bat.
	   Depois disso executar "regedit.exe /s %arquivoRegedit%" em um arquivo .bat separado.
	   
   10. No caso que a versão de Windows ainda não está homologada,
       verificar todas as propriedades do task criado no Task Scheduler:  
       a forma mais fácil é comparar com uma instalação em qualquer Windows Server 2008 R2 SP 1 
       onde a primeir task foi desenvolvida originalmente. 
       Fazer isso ainda no caso de Windows 10 e Windows Server 2012. 

       Se tiver alguma diferença, copiar Integração Portal Cronos - Fornecedor.Windows.2008_R2.TaskSchedule.xml 
       para outro arquivo novo, e adaptar Primeira_Instalacao_Versao_Windows.bat. 
       No outro caso que funcionou, adicionar o novo SO no nome do arquivo e adaptar Primeira_Instalacao_Versao_Windows.bat.

   11. No final, no caso que a versão de Windows ainda não estava homologada,
       descomentar "REM regedit.exe /s %arquivoRegedit%"
	   no arquivo Primeira_Instalacao_Versao_Windows.bat.
      
	   Também descomentar :
		  	) else (
			    echo MSGBOX "Esta versão de Windows ainda não está suportada ! Favor contatar o  Suporte do Portal Cronos." > %temp%\TEMPmessage.vbs
    			call %temp%\TEMPmessage.vbs
			    del %temp%\TEMPmessage.vbs /f /q
			    exit
			)

   11. Só uma vez: 
       No caso de Windows_10_Pro_64bit: testar e remover o seguinte: 
		REM Falta testar o seguinte!!!!!!!!!!!!!!!!!!!!!!!!
		REM Se é para usar %~dp0DeshabilitarJavaUpdates.x64.reg ou DeshabilitarJavaUpdates.x64.reg
		REM no seguinte caso de if %Windows_10_Pro_64bit% == 1:
		REM ) else if %Windows_10_Pro_64bit% == 1 (
		REM     set arquivoRegedit=DeshabilitarJavaUpdates.x64.reg

   

   12. No caso de Windows 10, no Agendador de Tarefas, alterar o dia / hora início para hoje após 5 min.
   
   13. No caso de integração com o SAP: 
			There are different distribution packages for various JRE versions and hardware processors available:
			
			    sapjco3-ntintel-3.0.17.zip for a 32-bit JRE running on a 32- or 64-bit AMD or INTEL x86 or a 64-bit INTEL Itanium processor
			    sapjco3-ntia64-3.0.17.zip for a 64-bit JRE running on a 64-bit INTEL Itanium processor
			    sapjco3-ntamd64-3.0.17.zip for a 64-bit JRE running on a 64-bit AMD or INTEL x86 processor 
			
			Note: Before installing JCo, please install the latest Microsoft Visual Studio 2005 C/C++ 
			      runtime libraries as described in note 684106.
			      Obs.: foi testado que tudo funcionou com o Microsoft Visual C/C++ 2010 x64 Redistributable 
			            e  o  Microsoft Visual C/C++ 2013 Redistributable x64 instalados ao mesmo tempo.
			
			To install JCo for Windows unzip the appropriate distribution package into 
			an own arbitrary directory {sapjco3-path}.
			
			Note: Do not copy the sapjco3.dll neither into the {windows-dir}\system32 
			      nor into the {windows-dir}\SysWOW64 directory. 
			      This will break the operability of other JCo versions that are already 
			      installed on the same system. Furthermore you would risk that the 
			      current installation also would not work anymore, if the sapjco3.dll 
			      gets replaced in the respective Windows system directory in the future.
			
			Then add {sapjco3-path} (C:\Arquivos de Programas PC\Integração Fornecedor - Portal Cronos\lib) 
			to the PATH environment variable.
			
			Finally, add {sapjco3-path}\sapjco3.jar to your CLASSPATH environment variable: 
			1. No Eclipse: .............. 
			2. Já foi feito automaticamente pelo pom.xml na geração do .jar. 

   14. (i)  Verificar se debug = true no arquivo de configuração para facilitar atendimento imediato no futuro.
       (ii) Verificar se o default de QtdDiasArquivosXmlGuardados = 100 
 
   15. Adicionar " and f.id_fornecedor_fornec <> xxx -- NNNNNN ainda não está em produção"
       na procedure [dbo].[monitorarIntegracaoFornecedores]
   
   16. update [dbo].[Usuario_Sistema]  
          set id_fornecedor_fornec = .....
        where cd_usuario_sistema_ususis = 'ericcoringa'
   
       Conectar no Portal Cronos (produção) logado como ericcoringa e verificar se eles usam 
       um texto padrão do fornecedor para todas as cotações de todos os compradores 
       e preencher isso no parâmetro "ObsOfertasPadraoSeNaoTemNoSistema". 
    
   17. Enviar Email/ Skype: 
   
       Vocês têm apenas UMA base de dados WinThor/Oracle? Ou talvez tem uma base de produção e outra base de teste, por exemplo?



       Qual é o endereço IP, porta, SID, usuário e senha do banco Oracle de produção? A porta é a porta "default" (1521) ?
       Pode ser um usuário que tem apenas privilêgio para consulta, pois o Portal Cronos precisa apenas consultar o estoque e os preços dos produtos e alguns dados dos clientes e não faz nenhum salvamento no WinThor.

       Se o DBA demorar demais para criar um usuário novo, não podemos usar um dos usuários Oracle que já existe? Com certeza deve existir pelo menos um. Eu posso até colocar a senha deste usuário no arquivo de parâmetros do Portal Cronos de forma criptografada. 


       Dúvida: na versão atual do Portal Cronos normalmente a senha fica registrada de forma NÃO criptografada no arquivo de configuração no diretório C:\Arquivos de Programas PC\Integração Fornecedor - Portal Cronos\conf\. Pode ser assim? Ou esta senha deve aparecer de forma criptografada neste arquivo?
       
Leão, 
   
  a SOST vai usar um usuário Oracle existente com mais privilêgios do que consulta, 
porém eles preferem que a gente vai registrar a senha no arquivo de configuração de forma criptografada.
Eu posso fazer uma versão nova do serviço de ofertas automáticas com esta funcionalidade nova. 
Previsão: 4 horas no máximo. Vou fazer hoje?
 
Atc,
Eric         
       No caso (falar primeiro com Leão): então vou desenvolver uma versão nova do Portal Cronos, eu faço isso em 4 horas.


Este usuário está dando erro "ORA-00942: a tabela ou view não existe" então este usuário não tem privilégios suficientes.
Sugiro conectar no SQL Navigator ou outra ferramenta com este usuário para ver se este usuário consegue visualizar pelo menos uma tabela ou nenhuma


       
Outra dúvida: os vendedores querem qual das seguintes opções?
1. que o WinThor envia automaticamente os preços ofertados de TODOS os produtos solicitados para o Portal Cronos mesmo no caso que o estoque de alguns produtos estiver zerado no WinThor? 
2. ou apenas os preços dos produtos solicitados que tiverem pelo menos 1 produto no estoque no WinThor?
3. ou apenas os preços dos produtos solicitados que tiverem uma quantidade no estoque no WinThor maior ou igual à quantidade solicitada?            

Exemplos de vantagens / desvantagens:
por exemplo uma possível desvantagem da opção 1: se o cliente escolher a SOST para fornecer alguns produtos e mandar uma ordem de compra, o risco é que vocês não vão conseguir cumprir o pedido ou apenas parcialmente
por exemplo uma possível desvantagem da opção 2 ou 3: no caso que o estoque da SOST não está sendo informado no WinThor, pode acontecer que a SOST vai perder oportunidades de vendas porque a integração automática vai deixar de ofertar produtos       
       

       No caso que os vendedores escolham fora do padrão (2): Todos os vendedores concordam com esta escolha?
        
       ANTIGO: Terminei minha parte da instalação. Favor verificar e salvar as seguintes chaves no arquivo de configuração que já está aberto no servidor atualmente: EnderecoIpServidorBancoDeDados, InstanciaBancoDeDados, UsuarioBancoDeDados, SenhaBancoDeDados, VerificarEstoque, CriterioVerificacaoEstoque, ObsOfertasPadraoSeNaoTemNoSistema, UsarValorMinimoSistemaFornecedor
    
    
Manual para a geração do instalador Setup.exe:
==============================================

1. No Windows Explorer (não no Eclipse) navegar na máquina de desenvolvimento para o diretório 
   C:\PCronos\Integração Fornecedor - Portal Cronos\Instalador\Windows\Arquivos de Programas PC\
   e ordenar os arquivos por nome alfabético.
    
2. Deletar ou renomear o arquivo "Instalador do Integrador Fornecedores - Portal Cronos.exe".
     
3. Usando o Winrar 4.01, criar um self extractable file com absolute path "C:/" 
   que cria /"Arquivos de Programas PC"/* no servidor do fornecedor, da seguinte forma :
      - Selecionar todos os arquivos e subdir no raiz do diretório navegado no Windows Explorer :
            - selecionar apenas UM dos dois arquivos jre-8u92-windows-i586.exe ou jre-8u92-windows-x64.exe
            - selecionar apenas UM dos dois arquivos DeshabilitarJavaUpdates.i586.reg ou DeshabilitarJavaUpdates.x64.reg
            - selecionar o subdiretório \Integração Fornecedor - Portal Cronos\ com conteúdo completa.
            - NÃO selecionar    Instalador*.exe                   
      - WinRAR                   : Mudar .rar para .zip
      - WinRAR                   : Método de compressão : Ótimo
      - WinRAR                   : marcar checkbox SFX
      - Nome                     : Instalador do Integrador Fornecedores - Portal Cronos.exe

   Aba "Avancado" do WinRAR > botão "Opções SFX..." : 
      - Caminho para extração    : C:\Arquivos de Programas PC (sem double quotes, e sem barra no final)
      - Marcar                   : Absolute path
      - Marcar ou deixar marcado : Checkbox "Salvar e restaurar caminho"
      - Executar após a extração : Primeira_Instalacao_Versao_Windows.bat 
                                   (pelo menos o Winrar 4.01 tem este After Extraction Trigger)
      - Sub-aba "Avançado"       : Marcar checkbox "Pedido de acesso administrativo"
      - Sub-aba "Métodos"        : Selecionar "Modo silencioso" > "Ocultar tudo"     
      - Sub-aba "Atualizar"      : Marcar "substituir todos os arquivos"
      - Sub-aba "Geral"          : Botão "Salvar configurações SFX" 
                                   Apenas na primeira vez. 
                                   Na segunda vez apenas abrir Aba "Avancado" > botão "Opções SFX..." e clicar OK.


IMPORTANTE !!!!!!!!
===================
Ao alterar o arquivo .bat do job, editar com o editor de DOS 
e não com o Notepad para evitar problemas com cedilhas e acentos !
 

 
